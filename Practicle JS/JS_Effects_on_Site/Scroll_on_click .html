<!DOCTYPE HTML>
<html lang="ru">
  <head>
    <style>
      .block {
        height: 800px;
        width: 100%;
      }
      .menu {
        background: #999999;
        color: white;
        height: 50px;
        text-align: center;
      }
      .fixed {
        position: fixed;
        width: 100%;
        top: 0px;
      }
      .active {

      }
    </style>
  </head>
  <body>
    <div id="block1" class="block" style="background: red"></div>
    <div class="menu">
      <span class="block1">1</span> <!-- класс нейм должен содержать id блока -->
      <span class="block2">2</span>
      <span class="block3">3</span>
      <span class="block4">4</span>
    </div>
    <div id="block2" class="block" style="background: yellow"></div> <!-- класс блок - нужен потому что надо задать каж блоку высоту. не играет роли в скрипте-->
    <div id="block3" class="block" style="background: green"></div>
    <div id="block4" class="block" style="background: blue"></div>
    <script>
      var menu = document.querySelector('.menu');
      var top1 = menu.offsetTop;
      var fixed = false;
       let lighted = 0; нулевой индекс, перый пункт подсвечивается, задаем это в переменной

      }
      document.onscroll = function() { на каждое движение скола
        if (!fixed && menu.getBoundingClientRect().top < 0) {
          menu.className += ' fixed';
          fixed = true;
        }
        else if (fixed && window.scrollY < top1) {
          menu.className = menu.className.split(' ')[0];
          fixed = false;
        }
        for (let i = 0, i < menu.children.lenght; i++) {
          let idblock = menu.children [i].className;
          let blockTop = document.querySelector('#' + idblock).offsetTop;
        if (scrolY >= blockTop) {
          menu.children[lighted].style.background = ' ';
          menu.children[i].style.background = ' green ';
          lighted = i;
        }

      else {

      }
      };



       let acvive = false;
       let scrollTarget ; // одна и таже анимация которая тянет то вверх то вниз
      menu.onclick = function(e) {
        let target = e.target; // элемент по которому кликнули
        let idblock = target.className; // извлекаем класс
        scrollTarget = document.querySelector('#' + idblock).offsetTop; //складываем значек # с классом что бы получить селектор сss #block x

        if (!active) {
          active = true;
        let t = setInterval(function() {
          if (Math.abs(scrollY - scrollTarget) < 15) {
            scrollTo(0, scrollTarget);
            clearInterval(t);
            active = false;
          } else if (scrollY < scrollTarget) {
            scrollBy(0, 40);
          } else if (scrollY > scrollTarget) {
            scrollBy(0, -40);
          }
        }, 15);
      }
      };
    </script>
  </body>
</html>
